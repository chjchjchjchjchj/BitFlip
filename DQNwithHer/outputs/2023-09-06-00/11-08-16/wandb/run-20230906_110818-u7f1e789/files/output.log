/root/miniconda3/envs/ling/lib/python3.9/site-packages/gym/logger.py:30: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  warnings.warn(colorize('%s: %s'%('WARN', msg % args), 'yellow'))
  0%|                                                                                              | 0/30000 [00:00<?, ?it/s]/root/BitFlip/DQNwithHer/DQNwithHER.py:103: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343997789/work/torch/csrc/utils/tensor_new.cpp:245.)
  state = torch.tensor([state], dtype=torch.float32).to(self.device)
win_rate=[0.0]
epsilon_array=[0.9]
log_episodes=[0]







  2%|█▍                                                                                  | 506/30000 [00:16<17:39, 27.83it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/11-08-16/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/11-08-16/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028]
epsilon_array=[0.9, 0.8253300000003398]








  3%|██▊                                                                                 | 984/30000 [00:33<15:35, 31.01it/s]
win_rate=[0.0, 0.028, 0.018]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864]









  5%|████▏                                                                              | 1504/30000 [00:50<17:54, 26.53it/s]
win_rate=[0.0, 0.028, 0.018, 0.016]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309]








  7%|█████▌                                                                             | 2008/30000 [01:07<15:04, 30.94it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706]








  8%|██████▊                                                                            | 2475/30000 [01:23<13:49, 33.19it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123]








 10%|████████▏                                                                          | 2964/30000 [01:39<13:01, 34.59it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008, 0.008]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123, 0.4499900000017704]









 12%|█████████▋                                                                         | 3508/30000 [01:57<13:54, 31.74it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008, 0.008, 0.002]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123, 0.4499900000017704, 0.3770000000016974]








 13%|███████████▏                                                                       | 4025/30000 [02:13<12:41, 34.09it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008, 0.008, 0.002, 0.0]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123, 0.4499900000017704, 0.3770000000016974, 0.30594000000162636]







 15%|████████████▍                                                                      | 4475/30000 [02:27<13:28, 31.57it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008, 0.008, 0.002, 0.0, 0.0]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123, 0.4499900000017704, 0.3770000000016974, 0.30594000000162636, 0.23696000000155737]







 17%|█████████████▋                                                                     | 4964/30000 [02:41<12:17, 33.95it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/11-08-16/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/11-08-16/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008, 0.008, 0.002, 0.0, 0.0, 0.002]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123, 0.4499900000017704, 0.3770000000016974, 0.30594000000162636, 0.23696000000155737, 0.1718900000014923]







 18%|███████████████▏                                                                   | 5481/30000 [02:55<10:49, 37.74it/s]
win_rate=[0.0, 0.028, 0.018, 0.016, 0.014, 0.008, 0.008, 0.002, 0.0, 0.0, 0.002, 0.002]
epsilon_array=[0.9, 0.8253300000003398, 0.7491900000006864, 0.6734800000010309, 0.5988500000013706, 0.5237500000017123, 0.4499900000017704, 0.3770000000016974, 0.30594000000162636, 0.23696000000155737, 0.1718900000014923, 0.11044000000145104]







 20%|████████████████▌                                                                  | 5980/30000 [03:10<12:44, 31.41it/s]
Traceback (most recent call last):
  File "/root/BitFlip/DQNwithHer/main.py", line 180, in <module>
    main()
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/root/BitFlip/DQNwithHer/main.py", line 146, in main
    agent.learn(transition_dict)
  File "/root/BitFlip/DQNwithHer/DQNwithHER.py", line 127, in learn
    q_values = self.q_net(states).gather(1, actions)
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/BitFlip/DQNwithHer/DQNwithHER.py", line 44, in forward
    x = F.relu(self.fc1(x))
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt