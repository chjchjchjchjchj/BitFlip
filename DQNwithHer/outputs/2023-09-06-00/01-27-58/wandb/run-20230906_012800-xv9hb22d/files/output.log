/root/miniconda3/envs/ling/lib/python3.9/site-packages/gym/logger.py:30: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  warnings.warn(colorize('%s: %s'%('WARN', msg % args), 'yellow'))
  0%|                                                                                              | 0/30000 [00:00<?, ?it/s]/root/BitFlip/DQNwithHer/DQNwithHER.py:101: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343997789/work/torch/csrc/utils/tensor_new.cpp:245.)
  state = torch.tensor([state], dtype=torch.float32).to(self.device)
  0%|                                                                                    | 1/30000 [00:00<6:26:12,  1.29it/s]
win_rate=[0.0]








  2%|█▎                                                                                  | 476/30000 [00:17<19:16, 25.52it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028]










  3%|██▊                                                                                | 1022/30000 [00:37<17:13, 28.04it/s]
win_rate=[0.0, 0.028, 0.016]









  5%|████▏                                                                              | 1523/30000 [00:55<16:13, 29.26it/s]
win_rate=[0.0, 0.028, 0.016, 0.016]









  7%|█████▌                                                                             | 2021/30000 [01:13<16:26, 28.35it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012]








  8%|██████▊                                                                            | 2483/30000 [01:29<15:23, 29.78it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004]









 10%|████████▎                                                                          | 3006/30000 [01:47<14:03, 32.01it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008]








 12%|█████████▋                                                                         | 3479/30000 [02:03<14:50, 29.77it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006]








 13%|██████████▉                                                                        | 3957/30000 [02:19<13:54, 31.22it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0]









 15%|████████████▍                                                                      | 4515/30000 [02:37<13:06, 32.40it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004]







 17%|█████████████▊                                                                     | 4973/30000 [02:51<12:59, 32.12it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004]








 18%|███████████████▏                                                                   | 5506/30000 [03:07<11:39, 35.04it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0]







 20%|████████████████▌                                                                  | 5998/30000 [03:21<11:04, 36.15it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0]







 22%|█████████████████▉                                                                 | 6482/30000 [03:35<11:02, 35.47it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0]







 23%|███████████████████▏                                                               | 6953/30000 [03:49<10:03, 38.20it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0]








 25%|████████████████████▊                                                              | 7511/30000 [04:05<10:46, 34.77it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002]







 27%|██████████████████████                                                             | 7988/30000 [04:19<12:39, 28.97it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0]








 28%|███████████████████████▌                                                           | 8513/30000 [04:35<10:46, 33.26it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0]







 30%|████████████████████████▉                                                          | 9003/30000 [04:49<09:59, 35.01it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002]







 32%|██████████████████████████▎                                                        | 9502/30000 [05:04<10:33, 32.38it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0]








 33%|███████████████████████████▋                                                       | 9989/30000 [05:19<10:23, 32.07it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0]







 35%|████████████████████████████▌                                                     | 10461/30000 [05:33<09:51, 33.02it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0]








 37%|██████████████████████████████                                                    | 10987/30000 [05:50<10:46, 29.42it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0]







 38%|███████████████████████████████▎                                                  | 11460/30000 [06:03<09:14, 33.44it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0]








 40%|████████████████████████████████▊                                                 | 12018/30000 [06:20<08:54, 33.62it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002]







 42%|██████████████████████████████████                                                | 12483/30000 [06:34<08:45, 33.36it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0]







 43%|███████████████████████████████████▍                                              | 12955/30000 [06:48<08:11, 34.67it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0]








 45%|████████████████████████████████████▉                                             | 13517/30000 [07:04<08:16, 33.17it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0]







 47%|██████████████████████████████████████▎                                           | 14005/30000 [07:18<08:21, 31.92it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0]







 48%|███████████████████████████████████████▌                                          | 14466/30000 [07:32<07:38, 33.87it/s]
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/q_net.pth
Saving checkpoint at /root/BitFlip/DQNwithHer/outputs/2023-09-06/01-27-58/checkpoint/target_q_net.pth
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.006]








 50%|█████████████████████████████████████████                                         | 15022/30000 [07:48<07:01, 35.51it/s]
win_rate=[0.0, 0.028, 0.016, 0.016, 0.012, 0.004, 0.008, 0.006, 0.0, 0.004, 0.004, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.0, 0.006, 0.0]




 51%|█████████████████████████████████████████▉                                        | 15359/30000 [07:58<07:35, 32.11it/s]
Traceback (most recent call last):
  File "/root/BitFlip/DQNwithHer/main.py", line 181, in <module>
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/root/BitFlip/DQNwithHer/main.py", line 112, in main
    agent.learn(transition_dict)
  File "/root/BitFlip/DQNwithHer/DQNwithHER.py", line 131, in learn
    dqn_loss.backward()
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/root/miniconda3/envs/ling/lib/python3.9/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt